<style>
    * {
    padding: 0;
    margin: 0;
}
    body {
        
    }

    .container div {

        float: left;
        padding: 1vw;
        border:1px solid #000;
        font-size: 0.5vw;
    }
</style>

<body>
    <div class="container" id="container">
    </div>

    <button id="start" onclick="quickSort(array, 0, 4, -1, 0, 'start')">Quick Sort</button>
    <button onclick="mergeSort(array, 0, 4)">Merge Sort</button>
    <button id="swap" onclick="swap(1,4)">swap</button>
    <p id="test">afdads</p>
</body>

<script>
    function shuffle(array) {
        array.sort(() => Math.random() - 0.5);
    }
    var array = [];

    for (var i = 0; i < 5; i++) {
        array[i] = i + 1;
    }
    shuffle(array);
    var container = document.getElementById('container');
    array.forEach (x => {
        var bar = document.createElement('div');
        bar.innerHTML = x;
        bar.id = String(x);
        bar.style.height =  x;
        container.appendChild(bar);
    });
    var li = 0;
    var red = true;

    var index = 0;
    var pivot = array[4];

    var a = -1;

    function swap(arr, i3, j3) {
        var i2 = arr[i3];
        var j2 = arr[j3];

        var iHTML = document.getElementById(String(i2));
 
        iHTML.innerHTML = j2;
        iHTML.style.height =   j2;

        var jHTML = document.getElementById(String(j2));
        jHTML.innerHTML = i2;
        jHTML.style.height = i2;

        iHTML.id = j2;
        jHTML.id = i2;
        
        arr[i3] = j2;
        arr[j3] = i2;
    }

    
var j = 0;
    function quickSort(arr, lo, hi, i, j, state) {
        setTimeout(function() {  

            if (lo <= hi) {

                console.log(state+ ": " + arr[j]);
                var x = arr[j];
                var pivot = arr[hi];
                
                    if (red) {
                        document.getElementById(String(x)).style.background = 'red';
                         red = false;
                     } else {
                         if (arr[j] < pivot) {
                            i += 1;
                             document.getElementById(String(x)).style.background = 'white';
                             red = true;
                             swap(arr, i, j);
                         }
                         document.getElementById(String(x)).style.background = 'white';
                         red = true;
                     }
                
                
    
                       
                if (li == 0) {   
                    li++;         
                    quickSort(arr, lo, hi, i, j, state);
                } else {
                    li = 0;
                    j++;
                    if (j > hi - 1) {
                        i += 1;
                        swap(arr, i, hi);
                        var z = i;
                        i = -1;
                        j = 0;
                        console.log("new");
                        quickSort(arr, lo, z-1,lo-1, lo, 'before');
                        quickSort(arr,z+1, hi, z, z+1, 'after');
                        
                    } else {
                        quickSort(arr,lo, hi, i, j, state);
                    }
                }      
            } else {
                console.log("done");
            }
                          
        }, 5)

    }

    function mergeSort(arr, beg, end) {
        if (beg < end) {
            var mid = (beg + end) / 2;
            mergeSort(arr, beg, mid);
            mergeSort(arr, mid + 1, end);
        }

    }


    
</script>